# The COOL Programming Language Compiler

This directory and its subdirectories contain source code for **coolc**,
the compiler for **Classroom Object Oriented Language** created for educational purposes by **Alexander Aiken**.

Please see the documentation provided in **docs/** for further
assistance with **coolc**.

## Getting the Source Code and Building COOLC

1. Checkout COOLC:
    - `git clone https://github.com/xp10rd/Compilers.git`

2. Configure and build COOLC:
    - Prerequirement: at least **clang-12**, **gtest**, **llvm-12**;
    - `cd coolc`
    - `build.sh [-release/-debug] [options]`<br>
    Some usefull options:
        - `-clean` --- clean build directory before compilation.
        - `-asan` --- build with AddressSanitizer (Debug only).
        - `-ubsan` --- build with UndefinedBehaviorSanitizer (Debug only).
        - `-test` --- run tests after building.
        - `-mips` --- build for SPIM emulator.
        - `-llvm` --- build with **LLVM** for host architecture.

3. Some usefull runtime options for **LLVM**-based build (pass them as argument to executable):
   1. `MaxHeapSize` --- maximal heap size (e.g. `MaxHeapSize=1024[Gb/Mb/Kb/no specifier for bytes]`).
   2. `GCAlgo` --- GC algorithm (e.g. `GCAlgo=1`):
      1. `ZeroGC` (code **0**) --- just allocate memory without collecting.
      2. `MarkSweepGC` (code **1**) --- use **Mark-and-Sweep** GC.
      3. `ThreadedCompactionGC` (code **2**) --- use **Jonkers's threaded compaction** (Mark-and-Compact) GC.
         1. For now all collectors use **LLVM Shadow Stack**.
         2. Default collector is `ThreadedCompactionGC`.
   3. `PrintGCStatistics` --- print some statistics about GC (e.g. `+PrintGCStatistics`).
   4. `PrintAllocatedObjects` --- (**debug only**) print object layout on every allocation (e.g. `+PrintAllocatedObjects`).

4. Note, that executables, that were generated by **coolc**, require runtime library (**libcool-rt.so**):
   1. This library is located in **bin** folder with **coolc**;
   2. You have to add it to your **LD_LIBRARY_PATH** (for **Linux**) or **DYLD_LIBRARY_PATH** (for **MacOS**);
   3. The easiest way to do it is to build compiler with command `source ./build.sh`